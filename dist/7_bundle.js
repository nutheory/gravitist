(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{477:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=N(a(56)),s=N(a(57)),r=N(a(32)),l=N(a(12)),i=N(a(15)),d=N(a(13)),u=N(a(14)),c=a(2),o=N(c),m=a(6),f=a(29),p=a(259),h=a(82),v=N(a(524)),g=(N(a(560)),N(a(499))),y=a(263),E=N(a(924));function N(e){return e&&e.__esModule?e:{default:e}}window.location.host.includes("homefilming");var b=function(e){function t(){(0,l.default)(this,t);var e=(0,d.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={userVerified:!1,contactsVerified:!1,userTypeOpen:!1,loading:!1,type:"unapproved_admin",contacts:[],errors:[]},e.toggleUserTypeOpen=e.toggleUserTypeOpen.bind(e),e.userTypeSelect=e.userTypeSelect.bind(e),e.handleInputChange=e.handleInputChange.bind(e),e.checkUserVerified=e.checkUserVerified.bind(e),e.handleReturnedContacts=e.handleReturnedContacts.bind(e),e.renderValidated=e.renderValidated.bind(e),e.runMutation=e.runMutation.bind(e),e.allCriteriaVerified=e.allCriteriaVerified.bind(e),e.handleSubmit=e.handleSubmit.bind(e),e}var c;return(0,u.default)(t,e),(0,i.default)(t,[{key:"renderValidated",value:function(){return o.default.createElement("span",{className:"",style:{opacity:""+(this.state.userVerified?1:0)}},o.default.createElement("i",{className:"fas fa-check"}))}},{key:"toggleUserTypeOpen",value:function(){this.setState({userTypeOpen:!this.state.userTypeOpen})}},{key:"userTypeSelect",value:function(e){this.setState({userType:e.currentTarget.getAttribute("value"),userTypeTitle:e.currentTarget.getAttribute("title"),userTypeOpen:!this.state.userTypeOpen})}},{key:"handleReturnedUser",value:function(e,t){var a=t.name,n=t.email,s=t.password;this.setState({userVerified:e,name:a,email:n,password:s})}},{key:"handleReturnedContacts",value:function(e){this.setState({contacts:e,contactsVerified:e.length>0})}},{key:"returnUploadInstance",value:function(){}},{key:"handleInputChange",value:function(e){var t=this;this.setState((0,r.default)({},e.currentTarget.name,e.currentTarget.value),(function(){t.checkUserVerified()}))}},{key:"checkUserVerified",value:function(){(0,y.isValidName)(this.state.name)&&(0,y.isValidEmail)(this.state.email)&&(0,y.isValidPassword)(this.state.password)&&this.state.confirmPassword===this.state.password?this.setState({userVerified:!0}):this.setState({userVerified:!1})}},{key:"allCriteriaVerified",value:function(){return!(!this.state.userVerified||!this.state.contactsVerified)}},{key:"submitErrorCheck",value:function(){if(this.allCriteriaVerified())return!0;this.state.userVerified||this.setState((function(e){return{errors:e.errors.concat({type:"user",section:"User info",message:"Please make sure all your user fields are valid."})}})),this.state.contactsVerified||this.setState((function(e){return{errors:e.errors.concat({type:"contacts",section:"Contacts",message:"Please add at least one valid point of contact."})}}))}},{key:"handleGQLErrors",value:function(e){var t=this;console.log(e),e.graphQLErrors.map((function(e){"UniqueEmailError"===e.message?t.setState((function(e){return{errors:e.errors.concat({type:"email",section:"Email address is taken",message:"The email address you entered is already in use. Would you like to login?"})}})):"RequiredFieldError"===e.message&&t.setState((function(e){return{errors:e.errors.concat({type:"user",section:"Missing Required Field",message:"Please check all your info."})}}))}))}},{key:"renderErrors",value:function(){return o.default.createElement("div",{className:"error-area hide-error "+(this.state.errors.length>0?" show-error":"")},o.default.createElement("h2",{className:"text-base font-bold"},"Please correct these errors"),this.state.errors.map((function(e,t){return o.default.createElement("div",{key:"error_"+t,className:"my-4"},o.default.createElement("h3",{className:"text-sm font-bold"},e.section),o.default.createElement("p",{className:"text-sm"},e.message),"email"===e.type?o.default.createElement(m.Link,{to:"/login",className:" action-button button-blue"},o.default.createElement("span",{className:" action-button-overlay"}),"Login"):null)})))}},{key:"renderButtonText",value:function(){return this.allCriteriaVerified()?"Submit":"Please enter required info..."}},{key:"runMutation",value:function(){var e=this;this.setState({loading:!this.state.loading},(0,s.default)(n.default.mark((function t(){var a,s,r,l;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h.toast.info("⏱️ Creating order... One moment please.",{autoClose:!1}),a=e.state.contacts.map((function(e){return(0,p.pick)(["type","content","status","default"],e)})),t.next=4,e.props.submitUser({contacts:a,state:e.state}).catch((function(t){e.handleGQLErrors(t)}));case 4:s=t.sent,r=s.data.createUser,r.user,l=r.auth,localStorage.setItem("hf_auth_header_token",l.token),e.setState({loading:!e.state.loading},(function(){this.props.history.push("/dashboard")}));case 8:case"end":return t.stop()}}),t,e)}))))}},{key:"handleSubmit",value:(c=(0,s.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.errors.length>0&&this.setState({errors:[]}),!this.submitErrorCheck()){e.next=5;break}this.runMutation(),e.next=6;break;case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this;return o.default.createElement("div",null,o.default.createElement("div",{className:"signup-container"},o.default.createElement("div",{className:"w-full rounded shadow p-6 border border-grey-dark"},o.default.createElement("div",{className:"signup-header"},o.default.createElement("div",{className:"w-48 h-48"},o.default.createElement(g.default,{header:"Upload avatar",circle:!0,fileTypeName:"photo",source:"MainOrder-Avatar",fieldname:"avatar",mimes:"images",endpoint:"/uploads/avatar",returnUploadInstance:this.returnUploadInstance})),o.default.createElement("div",{className:"flex-1 -mr-6"},o.default.createElement("div",{className:""},o.default.createElement("div",{className:"flex"},o.default.createElement("div",{className:"flex-1"}),o.default.createElement(m.Link,{className:"w-32 h-8 block",to:"/"},o.default.createElement("img",{src:"/"+a(43)}))),o.default.createElement("div",{className:"text-right text-sm font-bold"},"Create Admin")),o.default.createElement("div",{className:"ml-6 mt-6 dropdown relative inline-block "+(this.state.userTypeOpen?"is-active":"")},o.default.createElement("div",{className:"dropdown-trigger hover:cursor-pointer",onClick:this.toggleUserTypeOpen},o.default.createElement("button",{className:"select-faker","aria-haspopup":"true","aria-controls":"dropdown-menu"},o.default.createElement("span",null,this.state.userTypeTitle?this.state.userTypeTitle:"UserType"),o.default.createElement("span",{className:"inline-block ml-6"},o.default.createElement("i",{className:"fa fa-angle-down","aria-hidden":"true"})))),o.default.createElement("div",{className:"dropdown-menu "+(this.state.userTypeOpen?"block":"hidden"),id:"dropdown-menu",role:"menu"},o.default.createElement("div",{className:"p-2 flex flex-wrap bg-white border border-grey rounded"},[["Agent","agent"],["Pilot","pilot"],["Unapproved Admin","unapproved_admin"]].map((function(t,a){return o.default.createElement("a",{key:"opts_"+a,className:"w-full block px-2 py-1 hover:cursor-pointer",onClick:e.userTypeSelect,value:t[1],title:t[0]},t[0])}))))),o.default.createElement("div",{className:"px-6 pb-2"},o.default.createElement("div",{className:"mb-4"},o.default.createElement("div",{className:"text-sm font-bold mt-4"},"Full name"),o.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"name",type:"text",placeholder:"Full Name"}))))),o.default.createElement("div",{className:"border-b"},o.default.createElement("div",{className:"mb-4"},o.default.createElement("div",{className:"text-xs"},"Email address"),o.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"email",type:"text",placeholder:"Email address"})),o.default.createElement("div",{className:"flex mb-4 -mx-2"},o.default.createElement("div",{className:"flex-1 mx-2"},o.default.createElement("div",{className:"text-xs"},"Create password"),o.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"password",type:"password",placeholder:"Create password"}),o.default.createElement("div",{className:"text-xs mt-1"},"Password must be at least 8 characters in with capital and lowercase letters and include at least one number.")),o.default.createElement("div",{className:"flex-1 mx-2"},o.default.createElement("div",{className:"text-xs"},"Confirm password"),o.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"confirmPassword",type:"password",placeholder:"Confirm password"})))),o.default.createElement("div",{className:"pb-2"},o.default.createElement("div",{className:"my-4"},o.default.createElement("h3",{className:"mb-1"},"Points of contact")),o.default.createElement(v.default,{restrictedMode:!0,editMode:!0,handleReturnedContacts:this.handleReturnedContacts})),this.renderErrors(),o.default.createElement("div",{className:"mt-4"},o.default.createElement("a",{className:" action-button button-green",onClick:this.handleSubmit},o.default.createElement("span",{className:" action-button-overlay"}),this.renderButtonText())))))}}]),t}(c.Component);t.default=(0,f.graphql)(E.default,{props:function(e){var t=e.mutate;return{submitUser:function(e){var a=e.state,n=e.contacts;return t({variables:{input:{user:{name:a.name,email:a.email,password:a.password,type:a.userType,contacts:n}}}})}}}})(b)},560:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(32)),s=o(a(12)),r=o(a(15)),l=o(a(13)),i=o(a(14)),d=a(2),u=o(d),c=(a(16),o(a(561)),a(263));function o(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){(0,s.default)(this,t);var e=(0,l.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleInputChange=e.handleInputChange.bind(e),e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"handleInputChange",value:function(e){var t=this;this.setState((0,n.default)({},e.currentTarget.name,e.currentTarget.value),(function(){t.checkUserVerified()}))}},{key:"checkUserVerified",value:function(){(0,c.isValidName)(this.state.name)&&(0,c.isValidEmail)(this.state.email)&&(0,c.isValidPassword)(this.state.password)&&this.state.confirmPassword===this.state.password?this.props.handleReturnedUser(!0,this.state):this.props.userVerified&&this.props.handleReturnedUser(!1,this.state)}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("div",{className:"columns"},u.default.createElement("div",{className:"field column"},u.default.createElement("div",{className:"control has-icons-left has-icons-right"},u.default.createElement("input",{onChange:this.handleInputChange,className:"input is-medium",name:"name",type:"text",placeholder:"Full Name"}),u.default.createElement("span",{className:"icon is-medium is-left"},u.default.createElement("i",{className:"fa fa-user"})))),u.default.createElement("div",{className:"field column"},u.default.createElement("div",{className:"control has-icons-left has-icons-right"},u.default.createElement("input",{onChange:this.handleInputChange,className:"input is-medium",name:"email",type:"email",placeholder:"Email"}),u.default.createElement("span",{className:"icon is-medium is-left"},u.default.createElement("i",{className:"fa fa-envelope"}))))),u.default.createElement("div",{className:"columns"},u.default.createElement("div",{className:"field column"},u.default.createElement("div",{className:"control has-icons-left has-icons-right"},u.default.createElement("input",{onChange:this.handleInputChange,className:"input is-medium",name:"password",type:"password",placeholder:"Password"}),u.default.createElement("span",{className:"icon is-medium is-left"},u.default.createElement("i",{className:"fa fa-key"})))),u.default.createElement("div",{className:"field column"},u.default.createElement("div",{className:"control has-icons-left has-icons-right"},u.default.createElement("input",{onChange:this.handleInputChange,className:"input is-medium",name:"confirmPassword",type:"password",placeholder:"Re-type Password"}),u.default.createElement("span",{className:"icon is-medium is-left"},u.default.createElement("i",{className:"fa fa-lock"}))))))}}]),t}(d.Component);t.default=m},561:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s,r,l=a(32),i=(n=l)&&n.__esModule?n:{default:n},d=a(16),u=a(23);var c=d.StyleSheet.create({mainContainer:{maxWidth:"768px",padding:"2rem"},container:{paddingBottom:"2rem"},subtitle:{fontFamily:"Avenir Next, Helvetica, Arial, sans-serif",fontSize:"1.2rem",color:u.c.grey,marginBottom:"0px"},row:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"},area:{":first-child":(s={},(0,i.default)(s,u.ss.sm,{width:"100%"}),(0,i.default)(s,u.ss.md,{width:"calc(50% - 2rem)",marginRight:"2rem"}),s),":last-child":(r={},(0,i.default)(r,u.ss.sm,{width:"100%"}),(0,i.default)(r,u.ss.md,{width:"calc(50% - 2rem)",marginLeft:"2rem"}),r)},element:{fontFamily:"Avenir Next, Helvetica, Arial, sans-serif",fontSize:"1rem",width:"100%"},section:{paddingBottom:"3rem"},check:{color:u.c.green,paddingLeft:"20px",transition:"all .5s ease-in-out"},sectionHeader:{fontFamily:"Avenir Next, Helvetica, Arial, sans-serif",fontSize:"2rem",paddingBottom:"1rem",borderBottom:"1px solid "+u.c.lightGrey}});t.default=c},924:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,s(a(31)).default)(["\n  mutation($input: UserInput) {\n    createUser(input: $input){\n      user {\n        id\n        name\n        email\n        type\n      }\n      auth {\n        token\n      }\n    }\n  }\n"],["\n  mutation($input: UserInput) {\n    createUser(input: $input){\n      user {\n        id\n        name\n        email\n        type\n      }\n      auth {\n        token\n      }\n    }\n  }\n"]);function s(e){return e&&e.__esModule?e:{default:e}}var r=(0,s(a(30)).default)(n);t.default=r}}]);