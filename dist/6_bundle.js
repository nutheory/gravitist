(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=k(n(56)),r=k(n(57)),o=k(n(32)),i=k(n(12)),s=k(n(15)),c=k(n(13)),u=k(n(14)),d=n(2),l=k(d),p=n(29),y=n(6),m=n(259),f=n(263),h=n(82),g=k(n(264)),C=n(261),v=k(n(524)),O=k(n(555)),E=k(n(499)),z=k(n(922)),b=(k(n(36)),k(n(262)));function k(e){return e&&e.__esModule?e:{default:e}}var N=(0,C.getEnv)(window.location.host),x=g.default.stripe[N].publishable_key,w=function(e){function t(e){(0,i.default)(this,t);var n=(0,c.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={addressVerified:!1,userVerified:!1,contactsVerified:!1,paymentVerified:!1,avatarVerified:!1,selectedPlan:b.default.filter((function(t){return t.name===e.match.params.plan?t:null}))[0],price:b.default.filter((function(t){return t.name===e.match.params.plan?t:null}))[0].price,amountPaid:b.default.filter((function(t){return t.name===e.match.params.plan?t:null}))[0].actualPrice,loading:!1,userType:"agent",avatar:{},contacts:[],errors:[]},n.stripe=Stripe(x),n.elements=n.stripe.elements(),n.handleReturnedLocation=n.handleReturnedLocation.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleReturnedContacts=n.handleReturnedContacts.bind(n),n.handleReturnedPayment=n.handleReturnedPayment.bind(n),n.renderValidated=n.renderValidated.bind(n),n.fetchStripeToken=n.fetchStripeToken.bind(n),n.returnUploadInstance=n.returnUploadInstance.bind(n),n.runMutation=n.runMutation.bind(n),n.allCriteriaVerified=n.allCriteriaVerified.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}var d,p;return(0,u.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.card=this.elements.create("card"),this.card.mount("#card-element");var e=this;this.card.addEventListener("change",(function(t){t.complete?e.setState({paymentVerified:!0}):e.setState({paymentVerified:!1})}))}},{key:"renderValidated",value:function(){return l.default.createElement("span",{style:{opacity:""+(this.state.userVerified?1:0)}},l.default.createElement("i",{className:"fas fa-check"}))}},{key:"handleReturnedLocation",value:function(e){var t=e.address1,n=e.address2,a=e.city,r=e.state,o=e.zip,i=e.lat,s=e.lng;t&&a&&r&&o&&i&&s&&this.setState({address1:t,address2:n,city:a,state:r,zip:o,lat:i,lng:s,addressVerified:!0})}},{key:"handleInputChange",value:function(e){var t=this;this.setState((0,o.default)({},e.currentTarget.name,e.currentTarget.value),(function(){t.checkUserVerified()}))}},{key:"handleReturnedContacts",value:function(e){this.setState({contacts:e,contactsVerified:e.length>0})}},{key:"handleReturnedPayment",value:function(e){var t=this,n=e.discountId,a=e.discountedActualPrice,r=e.discountedPrice;n?this.setState({discountId:n,amountPaid:a,price:r}):this.setState({price:b.default.filter((function(e){return e.name===t.props.match.params.plan?e:null}))[0].price,amountPaid:b.default.filter((function(e){return e.name===t.props.match.params.plan?e:null}))[0].actualPrice,discountId:null})}},{key:"checkUserVerified",value:function(){(0,f.isValidName)(this.state.name)&&(0,f.isValidEmail)(this.state.email)&&(0,f.isValidPassword)(this.state.password)&&this.state.confirmPassword===this.state.password?this.setState({userVerified:!0}):this.setState({userVerified:!1})}},{key:"allCriteriaVerified",value:function(){return!!(this.state.addressVerified&&this.state.userVerified&&this.state.contactsVerified&&this.state.paymentVerified)}},{key:"returnUploadInstance",value:function(e){this.setState({avatar:e})}},{key:"submitErrorCheck",value:function(){if(this.allCriteriaVerified())return!0;this.state.addressVerified||this.setState((function(e){return{errors:e.errors.concat({type:"address",section:"Address",message:"Please choose a address option from the dropdown list."})}})),this.state.userVerified||this.setState((function(e){return{errors:e.errors.concat({type:"user",section:"User info",message:"Please make sure all your user fields are valid."})}})),this.state.contactsVerified||this.setState((function(e){return{errors:e.errors.concat({type:"contacts",section:"Contacts",message:"Please add at least one valid point of contact."})}}))}},{key:"handleGQLErrors",value:function(e){var t=this;e.graphQLErrors.map((function(e){"UniqueEmailError"===e.message||"Constraint"===e.name?t.setState((function(e){return{errors:e.errors.concat({type:"email",section:"Email address is taken",message:"The email address you entered is already in use. Would you like to login?"})}})):"RequiredFieldError"===e.message&&t.setState((function(e){return{errors:e.errors.concat({type:"user",section:"Missing Required Field",message:"Please check all your info."})}}))}))}},{key:"renderErrors",value:function(){return l.default.createElement("div",{className:"error-area hide-error "+(this.state.errors.length>0?" show-error":"")},l.default.createElement("h2",{className:"text-base font-bold"},"Please correct these errors"),this.state.errors.map((function(e,t){return l.default.createElement("div",{key:"error_"+t,className:"mt-4"},l.default.createElement("h3",{className:"text-sm font-bold"},e.section),l.default.createElement("p",{className:"text-sm mt-1"},e.message),"email"===e.type?l.default.createElement(y.Link,{to:"/login",className:" action-button button-blue w-1/4 mt-2"},l.default.createElement("span",{className:" action-button-overlay"}),"Login"):null)})))}},{key:"renderButtonText",value:function(){return this.allCriteriaVerified()&&this.state.avatar.plugins?"Submit Order":this.allCriteriaVerified()?"Don't forget your avatar...":"Please enter required info..."}},{key:"fetchStripeToken",value:(p=(0,r.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stripe.createToken(this.card);case 2:if(!(t=e.sent).error){e.next=8;break}n=Object.assign(t.error,{section:"Payment"}),this.setState((function(e){return{errors:e.errors.concat(n)}})),e.next=9;break;case 8:return e.abrupt("return",JSON.stringify(t.token));case 9:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"runMutation",value:function(e){var t=this;this.setState({loading:!this.state.loading},(0,r.default)(a.default.mark((function n(){var r,o,i,s,c;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return h.toast.info("⏱️ Creating order... One moment please.",{autoClose:!1}),r=t.state.contacts.map((function(e){return(0,m.pick)(["type","content","status","default"],e)})),n.next=4,t.props.submitOrder({contacts:r,token:e,state:t.state}).catch((function(e){t.handleGQLErrors(e)}));case 4:if(o=n.sent,i=o.data.createOrderWithUser,s=i.order,c=i.auth,localStorage.setItem("hf_auth_header_token",c.token),!t.state.avatar.plugins){n.next=16;break}return t.state.avatar.setMeta({uploadToId:s.agentId}),t.state.avatar.plugins.uploader[0].opts.headers.authorization=c.token,n.next=12,t.state.avatar.upload();case 12:n.sent.successful.length>0&&t.setState({loading:!t.state.loading}),n.next=17;break;case 16:t.setState({loading:!t.state.loading});case 17:t.props.history.push("/dashboard");case 19:case"end":return n.stop()}}),n,t)}))))}},{key:"handleSubmit",value:(d=(0,r.default)(a.default.mark((function e(t){var n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.errors.length>0&&this.setState({errors:[]}),e.next=3,this.fetchStripeToken();case 3:if(n=e.sent,!this.submitErrorCheck()){e.next=8;break}this.runMutation(n),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"render",value:function(){return l.default.createElement("div",{className:"signup-container"},l.default.createElement("div",{className:"w-full rounded shadow p-6 border border-grey-dark"},l.default.createElement("div",{className:"signup-header"},l.default.createElement("div",{className:"w-48 h-48"},l.default.createElement(E.default,{header:"Upload avatar",circle:!0,fileTypeName:"photo",source:"MainOrder-Avatar",fieldname:"avatar",mimes:"images",endpoint:"/uploads/avatar",returnUploadInstance:this.returnUploadInstance})),l.default.createElement("div",{className:"flex-1 -mr-6"},l.default.createElement("div",{className:""},l.default.createElement("div",{className:"flex"},l.default.createElement("div",{className:"flex-1"}),l.default.createElement(y.Link,{className:"w-32 h-8 block",to:"/"},l.default.createElement("img",{src:"/"+n(43)}))),l.default.createElement("div",{className:"text-right text-sm font-bold"},"Create Order")),l.default.createElement("div",{className:"px-6 pt-8 pb-2"},l.default.createElement("div",{className:"mb-4"},l.default.createElement("div",{className:"text-sm font-bold mt-4"},"Full name"),l.default.createElement("p",{className:"text-xs mt-1 mb-2"},"This is how your name will appear in all images/video watermarking"),l.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"name",type:"text",placeholder:"Full Name"}))))),l.default.createElement("div",{className:"border-b"},l.default.createElement("div",{className:"mb-4"},l.default.createElement("div",{className:"text-xs"},"Email address"),l.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"email",type:"text",placeholder:"Email address"})),l.default.createElement("div",{className:"flex mb-4 -mx-2"},l.default.createElement("div",{className:"flex-1 mx-2"},l.default.createElement("div",{className:"text-xs"},"Create password"),l.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"password",type:"password",placeholder:"Create password"}),l.default.createElement("div",{className:"text-xs mt-1"},"Password must be at least 8 characters in with capital and lowercase letters and include at least one number.")),l.default.createElement("div",{className:"flex-1 mx-2"},l.default.createElement("div",{className:"text-xs"},"Confirm password"),l.default.createElement("input",{onChange:this.handleInputChange,className:"input",name:"confirmPassword",type:"password",placeholder:"Confirm password"})))),l.default.createElement("div",{className:"border-b pb-2"},l.default.createElement("div",{className:"my-4"},l.default.createElement("h3",{className:"mb-1"},"Points of contact"),l.default.createElement("p",{className:"text-xs"},"These points of contact will be added to the watermarking of your assets.")),l.default.createElement(v.default,{restrictedMode:!0,editMode:!0,handleReturnedContacts:this.handleReturnedContacts})),l.default.createElement("div",{className:"my-4"},l.default.createElement("h3",{className:"mb-1"},"Order"),l.default.createElement("p",{className:"text-xs mt-1 mb-2"},"This is how your name will appear in all images/video watermarking")),l.default.createElement(O.default,{handleReturnedLocation:this.handleReturnedLocation,handleReturnedPayment:this.handleReturnedPayment,plan:this.state.selectedPlan,price:this.state.price,actualPrice:this.state.amountPaid}),this.renderErrors(),l.default.createElement("div",{className:"mt-4"},l.default.createElement("button",{disabled:!!this.state.loading,className:this.state.loading?"button-only bg-grey-light":" action-button button-green",onClick:this.handleSubmit},l.default.createElement("span",{className:" action-button-overlay"}),this.renderButtonText()))))}}]),t}(d.Component);t.default=(0,p.graphql)(z.default,{props:function(e){e.ownProps;var t=e.mutate;return{submitOrder:function(e){var n=e.state,a=e.contacts,r=e.token;return t({variables:{input:{user:{stripeToken:JSON.parse(r).id,name:n.name,email:n.email,password:n.password,contacts:a},order:{status:"pending",amountPaid:n.amountPaid,discountId:n.discountId,plan:{id:n.selectedPlan.planId,name:n.selectedPlan.name},address:{address1:n.address1,address2:n.address2,city:n.city,state:n.state,zipCode:n.zip,lat:n.lat,lng:n.lng}}}}})}}}})(w)},492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(56)),r=p(n(57)),o=p(n(12)),i=p(n(15)),s=p(n(13)),c=p(n(14)),u=n(2),d=p(u),l=p(n(508));function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){(0,o.default)(this,t);var e=(0,s.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={addressVerified:!1,addressSupprted:!0},e.deconstructPlaceIntoState=e.deconstructPlaceIntoState.bind(e),e}return(0,c.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("addressToFilm"),n=new google.maps.places.Autocomplete(t,{componentRestrictions:{country:"us"}});google.maps.event.addListener(n,"place_changed",(function(){var t=n.getPlace();if(t){t.geometry.location.lat(),t.geometry.location.lng();e.normalizeGooglePlace(t)}}))}},{key:"normalizeGooglePlace",value:function(e){var t={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};e.address_components.forEach((function(e,n){switch(e.types[0]){case"route":t.street=e.long_name;break;case"locality":t.city=e.long_name;break;case"country":t.country=e.long_name;break;case"street_number":t.street_number=e.long_name;break;case"postal_code":t.zip=e.long_name;break;case"administrative_area_level_1":t.state=e.short_name}})),this.deconstructPlaceIntoState(t)}},{key:"deconstructPlaceIntoState",value:function(e){var t=this;l.default.filter((function(t){return t.zipcode===e.zip})).length>0?this.setState({address1:e.street_number+" "+e.street,address2:"",city:e.city,state:e.state,zip:e.zip,lat:e.lat,lng:e.lng},(0,r.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({addressVerified:!0,addressSupprted:!0}),t.props.handleReturnedLocation(t.state);case 2:case"end":return e.stop()}}),e,t)})))):this.setState({addressSupprted:!1})}},{key:"render",value:function(){return d.default.createElement("div",null,d.default.createElement("div",{className:"relative"},d.default.createElement("input",{type:"textfield",className:"input pl-8",id:"addressToFilm"}),d.default.createElement("span",{className:"input-icon pin-l"},d.default.createElement("i",{className:"fa fa-home"}))),d.default.createElement("div",{className:"error-area hide-error "+(this.state.addressSupprted?"":"show-error")},"Unfortunatley the area you selected is not supported yet. Please be patient and check back soon."))}}]),t}(u.Component);t.default=y},508:function(e){e.exports=JSON.parse('[{"zipcode":"92602","city":"Irvine","county":"Orange County"},{"zipcode":"92603","city":"Irvine","county":"Orange County"},{"zipcode":"92604","city":"Irvine","county":"Orange County"},{"zipcode":"92605","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92606","city":"Irvine","county":"Orange County"},{"zipcode":"92607","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92607","city":"Laguna Niguel","county":"Orange County"},{"zipcode":"92609","city":"El Toro","county":"Orange County"},{"zipcode":"92609","city":"Lake Forest","county":"Orange County"},{"zipcode":"92610","city":"El Toro","county":"Orange County"},{"zipcode":"92610","city":"Foothill Ranch","county":"Orange County"},{"zipcode":"92612","city":"Irvine","county":"Orange County"},{"zipcode":"92614","city":"Laguna Niguel","county":"Orange County"},{"zipcode":"92609","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92609","city":"Lake Forest","county":"Orange County"},{"zipcode":"92610","city":"El Toro","county":"Orange County"},{"zipcode":"92610","city":"Foothill Ranch","county":"Orange County"},{"zipcode":"92612","city":"Irvine","county":"Orange County"},{"zipcode":"92614","city":"Irvine","county":"Orange County"},{"zipcode":"92615","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92616","city":"Irvine","county":"Orange County"},{"zipcode":"92618","city":"Irvine","county":"Orange County"},{"zipcode":"92619","city":"Irvine","county":"Orange County"},{"zipcode":"92620","city":"Irvine","county":"Orange County"},{"zipcode":"92623","city":"Irvine","county":"Orange County"},{"zipcode":"92624","city":"Capistrano Beach","county":"Orange County"},{"zipcode":"92624","city":"Dana Point","county":"Orange County"},{"zipcode":"92625","city":"Corona Del Mar","county":"Orange County"},{"zipcode":"92626","city":"Costa Mesa","county":"Orange County"},{"zipcode":"92627","city":"Costa Mesa","county":"Orange County"},{"zipcode":"92628","city":"Costa Mesa","county":"Orange County"},{"zipcode":"92629","city":"Monarch Bay","county":"Orange County"},{"zipcode":"92629","city":"Monarch Beach","county":"Orange County"},{"zipcode":"92629","city":"Dana Point","county":"Orange County"},{"zipcode":"92630","city":"El Toro","county":"Orange County"},{"zipcode":"92630","city":"Lake Forest","county":"Orange County"},{"zipcode":"92629","city":"Dana Point","county":"Orange County"},{"zipcode":"92630","city":"El Toro","county":"Orange County"},{"zipcode":"92630","city":"Lake Forest","county":"Orange County"},{"zipcode":"92637","city":"Laguna Hills","county":"Orange County"},{"zipcode":"92646","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92647","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92648","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92649","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92637","city":"Laguna Hills","county":"Orange County"},{"zipcode":"92646","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92647","city":"Huntington Beach","county":"Orange County"},{"zipcode":"92650","city":"East Irvine","county":"Orange County"},{"zipcode":"92650","city":"Irvine","county":"Orange County"},{"zipcode":"92651","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92652","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92653","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92653","city":"Aliso Viejo","county":"Orange County"},{"zipcode":"92653","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92653","city":"Laguna Hills","county":"Orange County"},{"zipcode":"92654","city":"Laguna Woods","county":"Orange County"},{"zipcode":"92654","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92654","city":"Laguna Hills","county":"Orange County"},{"zipcode":"92655","city":"Midway City","county":"Orange County"},{"zipcode":"92656","city":"Aliso Viejo","county":"Orange County"},{"zipcode":"92656","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92656","city":"Laguna Hills","county":"Orange County"},{"zipcode":"92657","city":"Newport Coast","county":"Orange County"},{"zipcode":"92657","city":"Newport Coast","county":"Orange County"},{"zipcode":"92658","city":"Newport Coast","county":"Orange County"},{"zipcode":"92659","city":"Newport Coast","county":"Orange County"},{"zipcode":"92660","city":"Newport Coast","county":"Orange County"},{"zipcode":"92661","city":"Newport Coast","county":"Orange County"},{"zipcode":"92662","city":"Newport Coast","county":"Orange County"},{"zipcode":"92663","city":"Newport Coast","county":"Orange County"},{"zipcode":"92672","city":"San Clemente","county":"Orange County"},{"zipcode":"92673","city":"San Clemente","county":"Orange County"},{"zipcode":"92674","city":"San Clemente","county":"Orange County"},{"zipcode":"92675","city":"Mission Viejo","county":"Orange County"},{"zipcode":"92675","city":"San Juan Capistrano","county":"Orange County"},{"zipcode":"92676","city":"Silverado","county":"Orange County"},{"zipcode":"92677","city":"Laguna Beach","county":"Orange County"},{"zipcode":"92677","city":"Laguna Niguel","county":"Orange County"},{"zipcode":"92678","city":"Trabuco","county":"Orange County"},{"zipcode":"92679","city":"Coto De Caza","county":"Orange County"},{"zipcode":"92679","city":"Dove Canyon","county":"Orange County"},{"zipcode":"92679","city":"Portola Hills","county":"Orange County"},{"zipcode":"92679","city":"Robinson Ranch","county":"Orange County"},{"zipcode":"92679","city":"Trabuco Cyn","county":"Orange County"},{"zipcode":"92679","city":"Trabuco","county":"Orange County"},{"zipcode":"92683","city":"Westminster","county":"Orange County"},{"zipcode":"92684","city":"Westminster","county":"Orange County"},{"zipcode":"92685","city":"Westminster","county":"Orange County"},{"zipcode":"92688","city":"Rancho Santa Margarita","county":"Orange County"},{"zipcode":"92690","city":"Mission Viejo","county":"Orange County"},{"zipcode":"92690","city":"San Juan Capistrano","county":"Orange County"},{"zipcode":"92691","city":"Mission Viejo","county":"Orange County"},{"zipcode":"92691","city":"San Juan Capistrano","county":"Orange County"},{"zipcode":"92692","city":"Mission Viejo","county":"Orange County"},{"zipcode":"92692","city":"San Juan Capistrano","county":"Orange County"},{"zipcode":"92693","city":"San Juan Capistrano","county":"Orange County"},{"zipcode":"92694","city":"Ladera Ranch","county":"Orange County"},{"zipcode":"92694","city":"Mission Viejo","county":"Orange County"}]')},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(56)),r=h(n(57)),o=h(n(12)),i=h(n(15)),s=h(n(13)),c=h(n(14)),u=n(2),d=h(u),l=n(29),p=h(n(0)),y=n(261),m=h(n(492)),f=h(n(556));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={planName:e.plan.name,planPrice:e.actualPrice,checking:!1,latLng:[],discountErrors:[]},n.handleReturnedLocation=n.handleReturnedLocation.bind(n),n.validateDiscount=n.validateDiscount.bind(n),n.checkDiscountCode=n.checkDiscountCode.bind(n),n.fetchAssociatedMap=n.fetchAssociatedMap.bind(n),n}var n;return(0,c.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){}},{key:"validateDiscount",value:function(e){return e.appliesTo&&"all"!==e.appliesTo&&this.state.planName!==e.appliesTo&&this.setState((function(e){return{discountErrors:e.discountErrors.concat("Discount does not apply.")}})),e.maxUsageCount&&e.usageCount>=e.maxUsageCount&&this.setState((function(e){return{discountErrors:e.discountErrors.concat("Discount eligibilty has ended.")}})),e.endAt&&e.startsAt&&(0,p.default)().isBetween(e.startsAt,e.endAt)&&this.setState((function(e){return{discountErrors:e.discountErrors.concat("Discount invalid.")}})),!(this.state.discountErrors.length>0)}},{key:"checkDiscountCode",value:function(e,t){var n=t.currentTarget.value;this.setState({checking:!0,discountErrors:[]},(0,r.default)(a.default.mark((function t(){var r,o,i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.query({query:f.default,variables:{input:{code:n}}});case 2:r=t.sent,(o=r.data.applyDiscount).discount?this.validateDiscount(o.discount)&&(i=o.discount.amount.includes("%")?(0,y.calcPercentageDiscount)({base:this.state.planPrice,percent:o.discount.amount}):(0,y.calcNumberDiscount)({base:this.state.planPrice,number:o.discount.amount}),this.props.handleReturnedPayment({discountId:o.discount.id,discountedActualPrice:i,discountedPrice:i.slice(0,i.length-2)+"."+i.slice(i.length-2,i.length)})):this.props.handleReturnedPayment({discountedActualPrice:null,discountedPrice:null,discountId:null}),console.log("err",this.state.discountErrors),this.setState({checking:!1,discount:o.discount?o.discount:null});case 7:case"end":return t.stop()}}),t,this)}))))}},{key:"fetchAssociatedMap",value:(n=(0,r.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.latLng.length>0)){e.next=5;break}return t={center:{lat:this.state.latLng[0],lng:this.state.latLng[1]},zoom:20,mapTypeId:"satellite",scrollwheel:!1},e.next=4,new google.maps.Map(document.getElementById("mapArea"),t);case 4:e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"handleReturnedLocation",value:function(e){var t=e.address1,n=e.address2,a=e.city,r=e.state,o=e.zip,i=e.lat,s=e.lng;this.setState({latLng:[i,s]},(function(){this.fetchAssociatedMap(),this.props.handleReturnedLocation({address1:t,address2:n,city:a,state:r,zip:o,lat:i,lng:s})}))}},{key:"render",value:function(){var e=this;return d.default.createElement("div",null,d.default.createElement("div",null,d.default.createElement("div",{className:"text-sm font-bold"},"Address to film"),d.default.createElement(m.default,{handleReturnedLocation:this.handleReturnedLocation})),d.default.createElement("div",{className:"flex"},d.default.createElement("div",{className:"w-2/5 pt-4"},d.default.createElement("p",{className:"text-sm font-bold"},"Your order includes..."),d.default.createElement("ul",{className:"my-2"},this.props.plan.features.map((function(e,t){return d.default.createElement("li",{key:"feature_"+t,className:"my-3 flex"},d.default.createElement("span",{className:"block mr-3 pt-1"},d.default.createElement("i",{className:"far fa-check-circle fa-lg"})),d.default.createElement("span",{className:"block text-sm"},e.desc))})))),d.default.createElement("div",{className:"w-3/5 ml-4 pt-4"},d.default.createElement("div",{className:"signup-map-area rounded",id:"mapArea"}))),d.default.createElement("div",{className:"my-4 flex"},d.default.createElement("div",{className:"w-1/2"},d.default.createElement(l.ApolloConsumer,null,(function(t){return d.default.createElement("div",null,d.default.createElement("div",{className:"text-sm font-bold"},"Do you have a discount code?"),d.default.createElement("input",{type:"text",placeholder:"Discount code",name:"discountCode",onChange:function(n){return e.checkDiscountCode(t,n)},className:"input"}))}))),d.default.createElement("div",{className:"w-1/2 flex "},d.default.createElement("div",{className:"flex-1 flex items-end pl-4"},this.state.discountErrors.length>0?this.state.discountErrors.map((function(e,t){return d.default.createElement("p",{className:"text-sm text-red",key:"err_"+t},e)})):(this.state.discount?this.state.discount.amount:"")+" "+(this.state.discount?" off":"")),d.default.createElement("div",{className:"flex text-xl font-bold items-end"},d.default.createElement("span",{className:"inline-block mb-2 mr-1 text-sm"},"$"),this.props.price))),d.default.createElement("div",{className:"my-4"},d.default.createElement("div",{className:"text-sm font-bold"},"Payment"),d.default.createElement("div",{id:"card-element",className:"input"})))}}]),t}(u.Component);t.default=g},556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,r(n(31)).default)(["\n  query applyDiscount($input: ApplyDiscountInput){\n    applyDiscount(input: $input){\n      discount{\n        id\n        code\n        startsAt\n        endsAt\n        appliesTo\n        usageCount\n        maxUsageCount\n        amount\n      }\n    }\n  }\n"],["\n  query applyDiscount($input: ApplyDiscountInput){\n    applyDiscount(input: $input){\n      discount{\n        id\n        code\n        startsAt\n        endsAt\n        appliesTo\n        usageCount\n        maxUsageCount\n        amount\n      }\n    }\n  }\n"]);function r(e){return e&&e.__esModule?e:{default:e}}var o=(0,r(n(30)).default)(a);t.default=o},922:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,r(n(31)).default)(["\n  mutation($input: OrderWithUserInput) {\n    createOrderWithUser(input: $input){\n      order {\n        id\n        agentId\n        plan\n        receiptId\n        status\n        address {\n          address1\n          address2\n          city\n          state\n          zipCode\n          lat\n          lng\n        }\n      }\n      auth {\n        token\n      }\n    }\n  }\n"],["\n  mutation($input: OrderWithUserInput) {\n    createOrderWithUser(input: $input){\n      order {\n        id\n        agentId\n        plan\n        receiptId\n        status\n        address {\n          address1\n          address2\n          city\n          state\n          zipCode\n          lat\n          lng\n        }\n      }\n      auth {\n        token\n      }\n    }\n  }\n"]);function r(e){return e&&e.__esModule?e:{default:e}}var o=(0,r(n(30)).default)(a);t.default=o}}]);