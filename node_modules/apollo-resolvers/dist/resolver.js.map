{"version":3,"sources":["../src/resolver.js"],"names":["createResolver","resFn","errFn","Promise","baseResolver","root","args","context","resolve","catch","e","then","parsedError","cResFn","cErrFn","childResFn","entry","r","childErrFn","err"],"mappings":";;;;;;;AAAA;;AACA;;AAGO,IAAMA,0CAAiB,SAAjBA,cAAiB,CAACC,KAAD,EAAQC,KAAR,EAAkB;AAC9C,MAAMC,UAAU,0BAAhB;AACA,MAAMC,eAAe,SAAfA,YAAe,CAACC,IAAD,EAAmC;AAAA,QAA5BC,IAA4B,uEAArB,EAAqB;AAAA,QAAjBC,OAAiB,uEAAP,EAAO;;AACtD;AACA,QAAI,CAAC,sBAAWN,KAAX,CAAL,EAAwB,OAAOE,QAAQK,OAAR,CAAgB,IAAhB,CAAP;AACxB,WAAO,qBAAUP,KAAV,EAAiBI,IAAjB,EAAuBC,IAAvB,EAA6BC,OAA7B,EAAsCE,KAAtC,CAA4C,aAAK;AACtD;AACA,UAAI,CAAC,sBAAWP,KAAX,CAAL,EAAwB,MAAMQ,CAAN;AACxB;AACA,aAAO,qBAAUR,KAAV,EAAiBG,IAAjB,EAAuBC,IAAvB,EAA6BC,OAA7B,EAAsCG,CAAtC,EAAyCC,IAAzC,CAA8C,uBAAe;AAClE;AACA,cAAMC,eAAeF,CAArB;AACD,OAHM,EAGJ,uBAAe;AAChB;AACA,cAAME,eAAeF,CAArB;AACD,OANM,CAAP;AAOD,KAXM,CAAP;AAYD,GAfD;;AAiBAN,eAAaJ,cAAb,GAA8B,UAACa,MAAD,EAASC,MAAT,EAAoB;AAChD,QAAMX,UAAU,0BAAhB;;AAEA,QAAMY,aAAa,SAAbA,UAAa,CAACV,IAAD,EAAOC,IAAP,EAAaC,OAAb,EAAyB;AAC1C;AACA,UAAMS,QAAQ,sBAAWf,KAAX,IAAoB,qBAAUA,KAAV,EAAiBI,IAAjB,EAAuBC,IAAvB,EAA6BC,OAA7B,CAApB,GAA4DJ,QAAQK,OAAR,CAAgB,IAAhB,CAA1E;AACA,aAAOQ,MAAML,IAAN,CAAW,aAAK;AACrB;AACA,YAAI,gCAAqBM,CAArB,CAAJ,EAA6B,OAAOA,CAAP;AAC7B;AACA,eAAO,sBAAWJ,MAAX,IAAqB,qBAAUA,MAAV,EAAkBR,IAAlB,EAAwBC,IAAxB,EAA8BC,OAA9B,CAArB,GAA8DJ,QAAQK,OAAR,CAAgB,IAAhB,CAArE;AACD,OALM,CAAP;AAMD,KATD;;AAWA,QAAMU,aAAa,SAAbA,UAAa,CAACb,IAAD,EAAOC,IAAP,EAAaC,OAAb,EAAsBY,GAAtB,EAA8B;AAC/C;AACA,UAAMH,QAAQ,sBAAWF,MAAX,IAAqB,qBAAUA,MAAV,EAAkBT,IAAlB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCY,GAAvC,CAArB,GAAmEhB,QAAQK,OAAR,CAAgB,IAAhB,CAAjF;;AAEA,aAAOQ,MAAML,IAAN,CAAW,aAAK;AACrB;AACA,YAAI,gCAAqBM,CAArB,CAAJ,EAA6B,MAAMA,CAAN;AAC7B;AACA,eAAO,sBAAWf,KAAX,IAAoB,qBAAUA,KAAV,EAAiBG,IAAjB,EAAuBC,IAAvB,EAA6BC,OAA7B,EAAsCY,GAAtC,EAA2CR,IAA3C,CAAgD,aAAK;AAC9E;AACA,gBAAMD,KAAKS,GAAX;AACD,SAH0B,EAGxB,aAAK;AACN;AACA,gBAAMT,KAAKS,GAAX;AACD,SAN0B,CAApB,GAMFhB,QAAQK,OAAR,CAAgB,IAAhB,CANL;AAOD,OAXM,CAAP;AAYD,KAhBD;;AAkBA;AACA,WAAOR,eAAee,UAAf,EAA2BG,UAA3B,CAAP;AACD,GAlCD;;AAoCA,SAAOd,YAAP;AACD,CAxDM","file":"resolver.js","sourcesContent":["import { getPromise } from './promise';\nimport { isFunction, Promisify, isNotNullOrUndefined } from './util';\n\n\nexport const createResolver = (resFn, errFn) => {\n  const Promise = getPromise();\n  const baseResolver = (root, args = {}, context = {}) => {\n    // Return resolving promise with `null` if the resolver function param is not a function\n    if (!isFunction(resFn)) return Promise.resolve(null);\n    return Promisify(resFn)(root, args, context).catch(e => {\n      // On error, check if there is an error handler.  If not, throw the original error\n      if (!isFunction(errFn)) throw e;\n      // Call the error handler.\n      return Promisify(errFn)(root, args, context, e).then(parsedError => {\n        // If it resolves, throw the resolving value or the original error.\n        throw parsedError || e\n      }, parsedError => {\n        // If it rejects, throw the rejecting value or the original error\n        throw parsedError || e\n      });\n    });\n  };\n\n  baseResolver.createResolver = (cResFn, cErrFn) => {\n    const Promise = getPromise();\n\n    const childResFn = (root, args, context) => {\n      // Start with either the parent resolver function or a no-op (returns null)\n      const entry = isFunction(resFn) ? Promisify(resFn)(root, args, context) : Promise.resolve(null);\n      return entry.then(r => {\n        // If the parent returns a value, continue\n        if (isNotNullOrUndefined(r)) return r;\n        // Call the child resolver function or a no-op (returns null)\n        return isFunction(cResFn) ? Promisify(cResFn)(root, args, context) : Promise.resolve(null);\n      });\n    };\n\n    const childErrFn = (root, args, context, err) => {\n      // Start with either the child error handler or a no-op (returns null)\n      const entry = isFunction(cErrFn) ? Promisify(cErrFn)(root, args, context, err) : Promise.resolve(null);\n      \n      return entry.then(r => {\n        // If the child returns a value, throw it\n        if (isNotNullOrUndefined(r)) throw r;\n        // Call the parent error handler or a no-op (returns null)\n        return isFunction(errFn) ? Promisify(errFn)(root, args, context, err).then(e => {\n          // If it resolves, throw the resolving value or the original error\n          throw e || err;\n        }, e => {\n          // If it rejects, throw the rejecting value or the original error\n          throw e || err;\n        }) : Promise.resolve(null);\n      });\n    };\n    \n    // Create the child resolver and return it\n    return createResolver(childResFn, childErrFn);\n  }\n\n  return baseResolver;\n};\n"]}